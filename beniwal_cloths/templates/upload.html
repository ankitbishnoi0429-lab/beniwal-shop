
{% extends "base.html" %}
{% block content %}
<div class="upload-container">
    <h2>Add New Product</h2>
    <form method="post" enctype="multipart/form-data">
        <fieldset>
            <legend>Seller Information</legend>
            <label>Seller name: <input name="name" placeholder="Enter seller name" required/></label><br/>
            <label>Seller phone: <input name="phone" placeholder="Seller's phone number" required/></label><br/>
            <label>Rating (0-5): <input name="rating" value="5" type="number" step="0.1"/></label><br/>
            <label>Latitude: <input name="lat" value="0" type="number" step="0.001"/></label><br/>
            <label>Longitude: <input name="lon" value="0" type="number" step="0.001"/></label><br/>
        </fieldset>
        
        <fieldset>
            <legend>Product Information</legend>
            <label>Product title: <input name="title" placeholder="Enter product name" required/></label><br/>
            <label>Category: 
                <select name="category" required>
                    <option value="">-- Select Category --</option>
                    <option value="Clothing">Clothing</option>
                    <option value="Accessories">Accessories</option>
                    <option value="Footwear">Footwear</option>
                    <option value="Traditional">Traditional Wear</option>
                    <option value="Other">Other</option>
                </select>
            </label><br/>
            <label>Price: <input name="price" type="number" step="0.01" placeholder="0.00" required/></label><br/>
            
            <label>Description (Optional - AI will generate if left empty):
                <textarea name="description" placeholder="Leave empty for AI-generated description" rows="3"></textarea>
            </label><br/>
            
            <label>Product Images (Upload 1-5 photos):
                <div class="image-upload-area">
                    <input type="file" name="images" accept="image/*" multiple required/>
                    <p class="help-text">ðŸ“¸ Upload multiple photos (JPG, PNG, GIF, WEBP). First image will be used for AI analysis.</p>
                    <div id="image-preview" class="preview-container"></div>
                </div>
            </label><br/>
            <label>Product Videos (optional):
                <div class="image-upload-area">
                    <input type="file" name="videos" accept="video/*" multiple />
                    <p class="help-text">ðŸŽ¥ Upload product video(s) (MP4, WEBM). If none provided, AI video generation may be attempted (if enabled).</p>
                    <div id="video-preview" class="preview-container"></div>
                </div>
            </label><br/>
            <label>Seller preference - allow seller to view buyer phone after order: <input type="checkbox" name="seller_view_buyer_phone" checked/></label><br/>
        </fieldset>
        
        <button type="submit">Upload Product</button>
    </form>
</div>

<script>
document.querySelector('input[name="images"]').addEventListener('change', function(e) {
    const preview = document.getElementById('image-preview');
    preview.innerHTML = '';
    
    const files = e.target.files;
    for (let i = 0; i < Math.min(files.length, 5); i++) {
        const file = files[i];
        const reader = new FileReader();
        
        reader.onload = function(event) {
            const div = document.createElement('div');
            div.className = 'preview-item';
            div.innerHTML = `
                <img src="${event.target.result}" alt="preview" />
                <span class="remove-btn" onclick="this.parentElement.remove()">âœ•</span>
            `;
            preview.appendChild(div);
        };
        
        document.querySelector('input[name="videos"]').addEventListener('change', function(e) {
            const preview = document.getElementById('video-preview');
            preview.innerHTML = '';
            const files = e.target.files;
            for (let i = 0; i < Math.min(files.length, 3); i++) {
                const file = files[i];
                const url = URL.createObjectURL(file);
                const div = document.createElement('div');
                div.className = 'preview-item';
                div.innerHTML = `<video src="${url}" controls style="width:100%;height:100%;object-fit:cover"></video>`;
                preview.appendChild(div);
            }
        });
        reader.readAsDataURL(file);
    }
});
</script>

<style>
    .upload-container {
        max-width: 700px;
        margin: 20px auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background: #f9f9f9;
    }
    
    .upload-container h2 {
        text-align: center;
        color: #333;
    }
    
    .upload-container fieldset {
        margin-bottom: 20px;
        padding: 15px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }
    
    .upload-container legend {
        padding: 0 10px;
        font-weight: bold;
        color: #007bff;
    }
    
    .upload-container label {
        display: block;
        margin-bottom: 10px;
        font-weight: 500;
    }
    
    .upload-container input[type="text"],
    .upload-container input[type="number"],
    .upload-container input[type="tel"],
    .upload-container select,
    .upload-container textarea {
        width: 100%;
        padding: 8px;
        margin-top: 5px;
        border: 1px solid #bbb;
        border-radius: 4px;
        font-family: inherit;
        font-size: 14px;
        box-sizing: border-box;
    }
    
    .upload-container select {
        cursor: pointer;
    }
    
    .upload-container textarea {
        resize: vertical;
        min-height: 60px;
    }
    
    .image-upload-area {
        background: #f0f8ff;
        padding: 15px;
        border-radius: 4px;
        border: 2px dashed #007bff;
        margin-top: 8px;
    }
    
    .image-upload-area input[type="file"] {
        width: 100%;
        padding: 10px;
        border: 1px solid #bbb;
        border-radius: 4px;
        cursor: pointer;
    }
    
    .help-text {
        font-size: 12px;
        color: #666;
        margin: 8px 0;
    }
    
    .preview-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        gap: 10px;
        margin-top: 10px;
    }
    
    .preview-item {
        position: relative;
        width: 80px;
        height: 80px;
        border-radius: 4px;
        overflow: hidden;
        border: 1px solid #ddd;
    }
    
    .preview-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .remove-btn {
        position: absolute;
        top: 2px;
        right: 2px;
        background: #dc3545;
        color: white;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-weight: bold;
        font-size: 12px;
    }
    
    .remove-btn:hover {
        background: #c82333;
    }
    
    .upload-container button {
        width: 100%;
        padding: 12px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 4px;
        font-size: 16px;
        cursor: pointer;
        font-weight: bold;
    }
    
    .upload-container button:hover {
        background: #218838;
    }
</style>
{% endblock %}

